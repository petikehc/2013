/*!
  [be]Lazy.js - v1.1.2 - 2014.01.03
  A lazy loading and multi-serving image script
  (c) Bjoern Klinggaard - @bklinggaard - http://dinbror.dk/blazy
*/
var Blazy=function(c,h){function g(b){if(!h.querySelectorAll){var e=h.createStyleSheet();h.querySelectorAll=function(b,a,c,f,g){g=h.all;a=[];b=b.replace(/\[for\b/gi,"[htmlFor").split(",");for(c=b.length;c--;){e.addRule(b[c],"k:v");for(f=g.length;f--;)g[f].currentStyle.k&&a.push(g[f]);e.removeRule(0)}return a}}a=b||{};a.src=a.src||"data-src";a.multi=a.multi||!1;a.error=a.error||!1;a.offset=a.offset||100;a.success=a.success||!1;a.selector=a.selector||".b-lazy";a.separator=a.separator||"|";a.container=a.container?h.querySelectorAll(a.container):!1;a.errorClass=a.errorClass||"b-error";a.successClass=a.successClass||"b-loaded";r=a.src;u=!0;f=v(w,20);s=v(x,50);x();m(a.multi,function(b){if(b.width>=c.screen.width)return r=b.src,!1});y()}function w(){for(var b=0;b<l;b++){var e=n[b],d=-1!==(" "+e.className+" ").indexOf(" "+a.successClass+" "),k=e.getBoundingClientRect(),c=z+a.offset;if(0<=k.left&&k.left<=A+a.offset&&(0<=k.top&&k.top<=c||k.bottom<=c&&k.bottom>=0-a.offset)||d)d||B(e),n.splice(b,1),l--,b--}0===l&&g.prototype.destroy()}function B(b){if(0<b.offsetWidth&&0<b.offsetHeight){var e=(b.getAttribute(r)||b.getAttribute(a.src)).split(a.separator),d=e[u&&1<e.length?1:0];d?(e=new Image,m(a.multi,function(a){b.removeAttribute(a.src)}),b.removeAttribute(a.src),e.onerror=function(){a.error&&a.error(b,"invalid");b.className=b.className+" "+a.errorClass},e.onload=function(){"img"===b.nodeName.toLowerCase()?b.src=d:b.setAttribute("style",'background-image: url("'+d+'");');b.className=b.className+" "+a.successClass;a.success&&a.success(b)},e.src=d):(a.error&&a.error(b,"missing"),b.className=b.className+" "+a.errorClass)}}function C(b){b=h.querySelectorAll(b);for(var a=l=b.length;a--;n.unshift(b[a]));}function x(){z=c.innerHeight||h.documentElement.clientHeight;A=c.innerWidth||h.documentElement.clientWidth}function y(){C(a.selector);t&&(t=!1,a.container&&m(a.container,function(b){p(b,"scroll",f)}),p(c,"scroll",f),p(c,"resize",f),p(c,"resize",s));w()}function p(b,a,d){b.attachEvent?b.attachEvent&&b.attachEvent("on"+a,d):b.addEventListener(a,d,!1)}function q(b,a,d){b.detachEvent?b.detachEvent&&b.detachEvent("on"+a,d):b.removeEventListener(a,d,!1)}function m(a,e){if(a&&e)for(var d=a.length,c=0;c<d&&!1!==e(a[c],c);c++);}function v(a,c){var d=0;return function(){var f=+new Date;f-d<c||(d=f,a.apply(this,arguments))}}var r,a,A,z,u,t=!0,l=0,n=[],f,s;g.prototype.revalidate=function(){y()};g.prototype.load=function(b){-1===(" "+b.className+" ").indexOf(" "+a.successClass+" ")&&B(b)};g.prototype.destroy=function(){a.container&&m(a.container,function(a){q(a,"scroll",f)});q(c,"scroll",f);q(c,"resize",f);q(c,"resize",s);l=0;n.length=0;t=!0};return g}(window,document);